

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>mwcz.org</title>
  <meta name="description" content="I finally created a blog.">
  <meta name="author" content="mwc">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>

  <link rel="stylesheet" href="/themes/mwc0/style.css?v=1">


</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header id="main_header">
  <div id="header" class="font-amiga">
    <h1><a href="/">mwcz.org</a></h1>

  </div>
  <div id="navigation" class="grid_12">

    <ul>
      <li><a href="/"
             class="">Home</a></li>
      <li><a href="/blog/archive"
             class="">Archives</a></li>
    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            




<div class="blog_post">
  <article>
    <header class="post_header_gradient">
      <a name="html5-canvas-eyedropper"></a>
      <h1 class="blog_post_title font-amiga"><a href="/blog/2011/11/16/html5-canvas-eyedropper" rel="bookmark" title="Permanent Link to HTML5 Canvas eyedropper">HTML5 Canvas eyedropper</a></h2>
      <div class="date theme_font2">
        2011
        16
        Nov
      </div>
    </header>
    <div class="post_body">
      <div class="post_prose">
        
<style type="text/css"> 
    #color { height: 80px; width: 80px; margin: 20px; display: block; border: 1px solid black; }
    canvas { margin: 0 auto; }
</style>

<script type="text/javascript">

var c;
var cnvs;

window.onload = function() {

cnvs = document.getElementById("c");

if( cnvs.getContext) { // Check for canvas support
    // DRAW FUN STUFF!

c = cnvs.getContext('2d');
        var color = document.getElementById("color");
        var colorcode = document.getElementById("colorcode");

var img = new Image();

img.onload = function() {
            cnvs.width = img.width;cnvs.height = img.height; // resize to fit image
            c.drawImage( img, 0, 0 );
        }
        img.src = "/img/001/kazoo.png";

pixel = function(e) {

// find the element's position
            var x = 0;
            var y = 0;
            var o = cnvs;
            do {
                x += o.offsetLeft;
                y += o.offsetTop;
            } while (o = o.offsetParent);

x = e.pageX - x;
            y = e.pageY - y;
            var imgdata = c.getImageData( x, y, 1, 1 );
            var new_color = [ imgdata.data[0], imgdata.data[1], imgdata.data[2] ];
            color.style.background = "rgb("+new_color+")";
            colorcode.innerHTML = "rgb("+new_color+")";
        }

cnvs.onmousedown = function(e) {
            cnvs.onmousemove = pixel; // fire pixel() while user is dragging
            cnvs.onclick = pixel; // only so it will still fire if user doesn't drag at all
        }

cnvs.onmouseup = function() {
            cnvs.onmousemove = null;
        }

}

}

</script>

<p>This is an old demo I made of an <a href="http://en.wikipedia.org/wiki/Canvas_element">HTML5 canvas</a> eyedropper.  Circa 2009, I believe.  Just click and drag on the image to see it in action.</p>
<p><span id="color"></span>
<span id="colorcode"></span></p>
<p><canvas id="c">Sorry, in order to view this demo you need a Web browser that supports HTML5 canvas.</canvas></p>
<p>It's a pretty simple script, and works by declaring this function which handles onclick and ondrag events from the canvas.  cnvs is the canvas element, and c is the canvas's 2D rendering context object.</p>
<div class="pygments_murphy syntax_highlight"><pre><span class="nx">pixel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span><br/>    <span class="c1">// calculate the x and y coordinates of the cursor</span><br/>    <span class="kd">var</span> <span class="nx">imgdata</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">getImageData</span><span class="p">(</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span><br/>    <span class="kd">var</span> <span class="nx">new_color</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">imgdata</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><br/>                      <span class="nx">imgdata</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <br/>                      <span class="nx">imgdata</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">];</span><br/>    <span class="nx">color</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="s2">&quot;rgb(&quot;</span><span class="o">+</span><span class="nx">new_color</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">;</span><br/><span class="p">}</span><br/></pre></div>

<p>That's just a summary; the function actually does a little more than that.  Take a look at the source for this page if you're interested, and contact me if there are any questions.</p>

      </div>
    </div>
    <footer class="post_footer_gradient">
      <div class="right">
       <span class="blog_post_categories"><a href='/blog/category/color'>color</a>, <a href='/blog/category/canvas'>canvas</a>, <a href='/blog/category/html5'>html5</a></span>
      </div>
    </footer>
  </article>
</div>



<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_url = "http://mwcz.org/blog/2011/11/16/html5-canvas-eyedropper";
</script>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2011/11/17/bouncey-returns---more-canvas-physics">Bouncey returns - more canvas physics</a></li>
      <li><a href="/blog/2011/11/17/bouncey---canvas-physics">Bouncey - canvas physics</a></li>
      <li><a href="/blog/2011/11/17/how-not-to-use-css3">How not to use CSS3</a></li>
      <li><a href="/blog/2011/11/17/html5-canvas-point-operations">HTML5 canvas point operations</a></li>
      <li><a href="/blog/2011/11/16/html5-canvas-area-selection-averaging">HTML5 canvas area selection averaging</a></li>
    </ul>
  </section>

  <section>
    <h1>Find me on...</h1>
    <ul>
        <li> <a href="https://www.github.com/mwcz">GitHub</a> </li>
        <li> <a href="http://stackoverflow.com/users/215148/mwcz">StackOverflow</a> </li>
        <li> <a href="http://clayto.com/">My Django-based photography site</a> </li>
        <li> <a href="https://twitter.com/#!/mwcz">Twitter</a> </li>
    </ul>
  </section>

  

</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2011
        mwc
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>

  </body>
</html>






